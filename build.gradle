plugins {
    id "com.diffplug.spotless" version "5.14.0"
}

apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'idea'

group 'uk.gov.di'

repositories {
    mavenCentral()
}

def dependencyVersions = [
    nimbus_oauth2_sdk: '9.10.2',
    nimbus_jose_jwt: '9.11.2',
    junit_version: '5.7.2',
    mockito_version: '3.11.2',
]

dependencies {
    implementation "com.nimbusds:oauth2-oidc-sdk:${dependencyVersions.nimbus_oauth2_sdk}",
            "com.nimbusds:nimbus-jose-jwt:${dependencyVersions.nimbus_jose_jwt}",
            "commons-codec:commons-codec:1.15"

    runtimeOnly "org.apache.logging.log4j:log4j-slf4j18-impl:2.14.1",
            "com.amazonaws:aws-lambda-java-log4j2:1.2.0"

    testImplementation "org.junit.jupiter:junit-jupiter-api:${dependencyVersions.junit_version}",
            "org.mockito:mockito-core:${dependencyVersions.mockito_version}",
            "org.mockito:mockito-junit-jupiter:${dependencyVersions.mockito_version}"

    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:${dependencyVersions.junit_version}"
}

spotless {
    java {
        target '**/*.java'
        googleJavaFormat('1.9').aosp()
        importOrder '', 'javax', 'java', '\\#'
    }

    groovyGradle {
        target '**/*.gradle'
        greclipse().configFile('tools/spotless-gradle.properties')
    }
}

test {
    useJUnitPlatform()
    workingDir = rootDir
}

mainClassName = 'uk.gov.di.AuthenticationApiApplication'

compileJava.dependsOn 'spotlessApply'
